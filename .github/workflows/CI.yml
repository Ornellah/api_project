name: CI
on: [push]
jobs:
  install-dependencies:
    name: Install dependencies ğŸ—ï¸
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.message, '[skip ci]')"
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
      - name: dependencies install 
        uses: actions/setup-python@v4
        with: 
          python-version: "3.12"
          cache: 'pip' 
          cache-dependency-path: '**/requirements.txt'
      - run: |
          pip install -r requirements.txt 
          npm install -g wait-on

  # unit-tests:
  #   needs: install-dependencies
  #   name: Run tests ğŸ§ª
  #   runs-on: ubuntu-latest
  #   if: "!contains(github.event.head_commit.message, '[skip ci]')"
  #   services:
  #     app:
  #       image: 280720/api_project:latest
  #       ports:
  #         - 5000:5000
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v3
  #     - name: dependencies install 
  #       uses: actions/setup-python@v4
  #       with: 
  #         python-version: "3.12"
  #         cache: 'pip' 
  #         cache-dependency-path: '**/requirements.txt'
  #     - run: |
  #         pip install -r requirements.txt
  #     - name: Wait for app to be ready
  #       run: sleep 60
  #     - name: Run tests
  #       run: pytest

  run-linters:
    needs: [install-dependencies]
    name: Run linter ğŸ’„
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.message, '[skip ci]')"
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.12"
          cache: 'pip'
          cache-dependency-path: '**/requirements.txt'
      - name: Install Python dependencies
        run: pip install black flake8
      - name: Run linters
        uses: wearerequired/lint-action@v2
        with:
          github_token: ${{ secrets.github_token }}
          black: true
          flake8: true


 